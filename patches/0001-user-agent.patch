From 66f7739b91be84f7034d8232078d8313ec9be094 Mon Sep 17 00:00:00 2001
From: ocobleseqx <oscar.cobles@eu.equinix.com>
Date: Tue, 31 Oct 2023 17:13:45 +0100
Subject: [PATCH] user agent

Signed-off-by: ocobleseqx <oscar.cobles@eu.equinix.com>
---
 equinix/config.go | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)

diff --git a/equinix/config.go b/equinix/config.go
index 085100e..ebe0192 100644
--- a/equinix/config.go
+++ b/equinix/config.go
@@ -23,7 +23,6 @@ import (
 	"github.com/hashicorp/go-retryablehttp"
 	"github.com/hashicorp/terraform-plugin-sdk/v2/helper/logging"
 	"github.com/hashicorp/terraform-plugin-sdk/v2/helper/schema"
-	"github.com/hashicorp/terraform-plugin-sdk/v2/meta"
 	"github.com/packethost/packngo"
 	xoauth2 "golang.org/x/oauth2"
 )
@@ -266,9 +265,8 @@ func MetalRetryPolicy(ctx context.Context, resp *http.Response, err error) (bool
 	return false, nil
 }
 
-func terraformUserAgent(version string) string {
-	ua := fmt.Sprintf("HashiCorp Terraform/%s (+https://www.terraform.io) Terraform Plugin SDK/%s",
-		version, meta.SDKVersionString())
+func pulumiUserAgent(version string) string {
+	ua := fmt.Sprintf("Pulumi/%s (+https://www.pulumi.com)", version)
 
 	if add := os.Getenv(uaEnvVar); add != "" {
 		add = strings.TrimSpace(add)
@@ -323,7 +321,9 @@ func generateModuleUserAgentString(d *schema.ResourceData, baseUserAgent string)
 }
 
 func (c *Config) fullUserAgent(suffix string) string {
-	tfUserAgent := terraformUserAgent(c.terraformVersion)
-	userAgent := fmt.Sprintf("%s terraform-provider-equinix/%s %s", tfUserAgent, version.ProviderVersion, suffix)
+	// FORK: this gives us the ability to add a Pulumi Specific user agent
+	// TODO (ocobles) override pulumi sdk version with ldflags
+	pulumiUserAgent := pulumiUserAgent("3.0")
+	userAgent := fmt.Sprintf("%s pulumi-equinix/%s %s", pulumiUserAgent, version.ProviderVersion, suffix)
 	return strings.TrimSpace(userAgent)
 }
-- 
2.39.1

